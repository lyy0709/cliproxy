import{_ as V,u as L,r as i,a as _,o as I,c as l,b as e,d as N,w as S,e as h,f as g,v as x,t as w,g as A,h as D,i as E,j as U,k as z,l as P,E as b,m as K,n as r,p as T}from"./index-CQyKkE5B.js";const j={class:"login-page"},H={class:"login-card"},R={class:"form-group"},$={class:"input-wrapper"},q={key:0,class:"form-error"},F={class:"form-group"},G={class:"input-wrapper"},J=["type"],O={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},Q={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},W={key:0,class:"form-error"},X={key:0,class:"form-group"},Y={class:"captcha-row"},Z={class:"input-wrapper captcha-input"},ee=["title"],se=["src"],te={key:1,class:"captcha-placeholder"},ae={key:0,class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},oe={key:1},le={key:0,class:"form-error"},re=["disabled"],ne={key:0,class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ie={key:1},ce={class:"login-footer"},de={__name:"Login",setup(pe){const k=K(),C=L(),d=i(!1),p=i(!1),u=i(!1),v=i(""),f=i(""),c=i(!0),a=_({username:"",password:"",captchaCode:""}),o=_({username:"",password:"",captcha:""});async function m(){u.value=!0;try{const t=await P.getCaptcha();if(t.data.enabled===!1){c.value=!1,f.value="",v.value="";return}c.value=!0,f.value=t.data.captcha_id||"",v.value=t.data.image||""}catch{b.error("获取验证码失败")}finally{u.value=!1}}function M(){let t=!0;return o.username="",o.password="",o.captcha="",a.username.trim()||(o.username="请输入用户名",t=!1),a.password||(o.password="请输入密码",t=!1),c.value&&(f.value?a.captchaCode.trim()||(o.captcha="请输入验证码",t=!1):(o.captcha="验证码未加载，请刷新",t=!1)),t}async function y(){if(M()){d.value=!0;try{const t={username:a.username,password:a.password};c.value&&(t.captcha_id=f.value,t.captcha_code=a.captchaCode);const s=await C.login(t);b.success("登录成功"),s.data.must_change_password?k.push("/force-change-password"):k.push("/admin/system-monitor")}catch{m(),a.captchaCode=""}finally{d.value=!1}}}return I(()=>{m()}),(t,s)=>{const B=z("router-link");return r(),l("div",j,[s[16]||(s[16]=e("div",{class:"bg-decoration"},[e("div",{class:"bg-circle bg-circle-1"}),e("div",{class:"bg-circle bg-circle-2"}),e("div",{class:"bg-circle bg-circle-3"})],-1)),e("div",H,[s[15]||(s[15]=N('<div class="login-header" data-v-9998388e><div class="logo" data-v-9998388e><svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-9998388e><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" data-v-9998388e></path></svg></div><h1 class="login-title" data-v-9998388e>Cli-Proxy</h1><p class="login-subtitle" data-v-9998388e>AI API 代理管理平台</p></div>',1)),e("form",{class:"login-form",onSubmit:S(y,["prevent"])},[e("div",R,[s[5]||(s[5]=e("label",{class:"form-label"},"用户名",-1)),e("div",$,[s[4]||(s[4]=e("svg",{class:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),e("circle",{cx:"12",cy:"7",r:"4"})],-1)),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>a.username=n),type:"text",class:"form-input",placeholder:"请输入用户名",autocomplete:"username"},null,512),[[x,a.username]])]),o.username?(r(),l("span",q,w(o.username),1)):h("",!0)]),e("div",F,[s[9]||(s[9]=e("label",{class:"form-label"},"密码",-1)),e("div",G,[s[8]||(s[8]=e("svg",{class:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e("path",{d:"M7 11V7a5 5 0 0110 0v4"})],-1)),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>a.password=n),type:p.value?"text":"password",class:"form-input",placeholder:"请输入密码",autocomplete:"current-password"},null,8,J),[[A,a.password]]),e("button",{type:"button",class:"password-toggle",onClick:s[2]||(s[2]=n=>p.value=!p.value)},[p.value?(r(),l("svg",Q,[...s[7]||(s[7]=[e("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"},null,-1),e("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(r(),l("svg",O,[...s[6]||(s[6]=[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])]),o.password?(r(),l("span",W,w(o.password),1)):h("",!0)]),c.value?(r(),l("div",X,[s[12]||(s[12]=e("label",{class:"form-label"},"验证码",-1)),e("div",Y,[e("div",Z,[s[10]||(s[10]=e("svg",{class:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})],-1)),g(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>a.captchaCode=n),type:"text",class:"form-input",placeholder:"请输入验证码",autocomplete:"off",onKeyup:D(y,["enter"])},null,544),[[x,a.captchaCode]])]),e("div",{class:"captcha-image-wrapper",onClick:m,title:u.value?"加载中...":"点击刷新"},[v.value?(r(),l("img",{key:0,src:v.value,alt:"验证码",class:"captcha-image"},null,8,se)):(r(),l("div",te,[u.value?(r(),l("svg",ae,[...s[11]||(s[11]=[e("circle",{cx:"12",cy:"12",r:"10","stroke-opacity":"0.25"},null,-1),e("path",{d:"M12 2a10 10 0 019.95 9","stroke-linecap":"round"},null,-1)])])):(r(),l("span",oe,"加载中"))]))],8,ee)]),o.captcha?(r(),l("span",le,w(o.captcha),1)):h("",!0)])):h("",!0),e("button",{type:"submit",class:"login-btn",disabled:d.value},[d.value?(r(),l("svg",ne,[...s[13]||(s[13]=[e("circle",{cx:"12",cy:"12",r:"10","stroke-opacity":"0.25"},null,-1),e("path",{d:"M12 2a10 10 0 019.95 9","stroke-linecap":"round"},null,-1)])])):(r(),l("span",ie,"登录"))],8,re)],32),e("div",ce,[E(B,{to:"/",class:"back-link"},{default:U(()=>[...s[14]||(s[14]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),e("polyline",{points:"12,19 5,12 12,5"})],-1),T(" 返回首页 ",-1)])]),_:1})])])])}}},ve=V(de,[["__scopeId","data-v-9998388e"]]);export{ve as default};
