import{_ as z,u as A,r as g,a as b,q as i,c as o,b as s,d as L,w as D,e as y,f as P,g as _,t as k,s as d,m as N,n as r,l as E,E as U}from"./index-CQyKkE5B.js";const $={class:"force-change-page"},F={class:"change-card"},I={class:"form-group"},R={class:"input-wrapper"},T=["type"],Z={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},j={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},G={key:0,class:"form-error"},H={key:0,class:"password-strength"},J={class:"strength-bars"},K={class:"password-requirements"},O={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Q={key:0,points:"20,6 9,17 4,12"},W={key:1,cx:"12",cy:"12",r:"10"},X={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y={key:0,points:"20,6 9,17 4,12"},ss={key:1,cx:"12",cy:"12",r:"10"},es={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ts={key:0,points:"20,6 9,17 4,12"},os={key:1,cx:"12",cy:"12",r:"10"},rs={class:"form-group"},ns={class:"input-wrapper"},as=["type"],ls={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},is={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},ds={key:0,class:"form-error"},us=["disabled"],cs={key:0,class:"spinner",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},vs={key:1},ws={__name:"ForceChangePassword",setup(ps){const x=N(),C=A(),p=g(!1),f=g(!1),m=g(!1),t=b({newPassword:"",confirmPassword:""}),a=b({newPassword:"",confirmPassword:""}),u=i(()=>t.newPassword.length>=8),c=i(()=>/[a-zA-Z]/.test(t.newPassword)),v=i(()=>/\d/.test(t.newPassword)),M=i(()=>/[!@#$%^&*(),.?":{}|<>]/.test(t.newPassword)),l=i(()=>{let n=0;return u.value&&n++,c.value&&v.value&&n++,M.value&&t.newPassword.length>=12&&n++,n}),h=i(()=>l.value===1?"weak":l.value===2?"medium":l.value===3?"strong":""),B=i(()=>l.value===1?"弱":l.value===2?"中":l.value===3?"强":""),V=i(()=>u.value&&c.value&&v.value&&t.confirmPassword===t.newPassword&&t.confirmPassword.length>0);function S(){let n=!0;return a.newPassword="",a.confirmPassword="",t.newPassword?(!u.value||!c.value||!v.value)&&(a.newPassword="密码不符合要求",n=!1):(a.newPassword="请输入新密码",n=!1),t.confirmPassword?t.confirmPassword!==t.newPassword&&(a.confirmPassword="两次输入的密码不一致",n=!1):(a.confirmPassword="请确认新密码",n=!1),n}async function q(){if(S()){p.value=!0;try{await E.forceChangePassword({new_password:t.newPassword,confirm_password:t.confirmPassword}),C.setMustChangePassword(!1),U.success("密码修改成功"),x.push("/admin/system-monitor")}catch{}finally{p.value=!1}}}return(n,e)=>(r(),o("div",$,[e[17]||(e[17]=s("div",{class:"bg-decoration"},[s("div",{class:"bg-circle bg-circle-1"}),s("div",{class:"bg-circle bg-circle-2"}),s("div",{class:"bg-circle bg-circle-3"})],-1)),s("div",F,[e[16]||(e[16]=L('<div class="card-header" data-v-9bbe4447><div class="warning-icon" data-v-9bbe4447><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-9bbe4447><path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-9bbe4447></path></svg></div><h1 class="card-title" data-v-9bbe4447>安全提醒</h1><p class="card-subtitle" data-v-9bbe4447>首次登录，请修改默认密码以确保账户安全</p></div>',1)),s("form",{class:"password-form",onSubmit:D(q,["prevent"])},[s("div",I,[e[7]||(e[7]=s("label",{class:"form-label"},"新密码",-1)),s("div",R,[e[6]||(e[6]=s("svg",{class:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[s("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s("path",{d:"M7 11V7a5 5 0 0110 0v4"})],-1)),P(s("input",{"onUpdate:modelValue":e[0]||(e[0]=w=>t.newPassword=w),type:f.value?"text":"password",class:"form-input",placeholder:"请输入新密码",autocomplete:"new-password"},null,8,T),[[_,t.newPassword]]),s("button",{type:"button",class:"password-toggle",onClick:e[1]||(e[1]=w=>f.value=!f.value)},[f.value?(r(),o("svg",j,[...e[5]||(e[5]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(r(),o("svg",Z,[...e[4]||(e[4]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])]),a.newPassword?(r(),o("span",G,k(a.newPassword),1)):y("",!0)]),t.newPassword?(r(),o("div",H,[s("div",J,[s("div",{class:d(["strength-bar",l.value>=1?h.value:""])},null,2),s("div",{class:d(["strength-bar",l.value>=2?h.value:""])},null,2),s("div",{class:d(["strength-bar",l.value>=3?h.value:""])},null,2)]),s("span",{class:d(["strength-text",h.value])},k(B.value),3)])):y("",!0),s("div",K,[s("div",{class:d(["requirement",u.value?"valid":""])},[(r(),o("svg",O,[u.value?(r(),o("polyline",Q)):(r(),o("circle",W))])),e[8]||(e[8]=s("span",null,"至少 8 个字符",-1))],2),s("div",{class:d(["requirement",c.value?"valid":""])},[(r(),o("svg",X,[c.value?(r(),o("polyline",Y)):(r(),o("circle",ss))])),e[9]||(e[9]=s("span",null,"包含字母",-1))],2),s("div",{class:d(["requirement",v.value?"valid":""])},[(r(),o("svg",es,[v.value?(r(),o("polyline",ts)):(r(),o("circle",os))])),e[10]||(e[10]=s("span",null,"包含数字",-1))],2)]),s("div",rs,[e[14]||(e[14]=s("label",{class:"form-label"},"确认密码",-1)),s("div",ns,[e[13]||(e[13]=s("svg",{class:"input-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[s("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s("path",{d:"M7 11V7a5 5 0 0110 0v4"})],-1)),P(s("input",{"onUpdate:modelValue":e[2]||(e[2]=w=>t.confirmPassword=w),type:m.value?"text":"password",class:"form-input",placeholder:"请再次输入新密码",autocomplete:"new-password"},null,8,as),[[_,t.confirmPassword]]),s("button",{type:"button",class:"password-toggle",onClick:e[3]||(e[3]=w=>m.value=!m.value)},[m.value?(r(),o("svg",is,[...e[12]||(e[12]=[s("path",{d:"M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24"},null,-1),s("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])])):(r(),o("svg",ls,[...e[11]||(e[11]=[s("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),s("circle",{cx:"12",cy:"12",r:"3"},null,-1)])]))])]),a.confirmPassword?(r(),o("span",ds,k(a.confirmPassword),1)):y("",!0)]),s("button",{type:"submit",class:"submit-btn",disabled:p.value||!V.value},[p.value?(r(),o("svg",cs,[...e[15]||(e[15]=[s("circle",{cx:"12",cy:"12",r:"10","stroke-opacity":"0.25"},null,-1),s("path",{d:"M12 2a10 10 0 019.95 9","stroke-linecap":"round"},null,-1)])])):(r(),o("span",vs,"确认修改"))],8,us)],32)])]))}},ms=z(ws,[["__scopeId","data-v-9bbe4447"]]);export{ms as default};
