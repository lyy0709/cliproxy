import{_ as R,r as c,q as V,o as w,c as n,b as t,p as h,s as f,e as m,F as x,x as C,f as D,v as I,l as N,n as o,t as l,G as L}from"./index-CQyKkE5B.js";const z={class:"account-load-page"},A={class:"page-header"},E=["disabled"],P={class:"filter-card"},U={class:"filter-row"},G={class:"filter-group"},H={class:"time-range-selector"},K=["onClick"],$={key:0,class:"filter-group"},j={class:"date-inputs"},J={class:"table-card"},Q={class:"table-container"},W={class:"data-table"},X={key:0},Y={class:"id-code"},Z={class:"account-name"},tt={class:"col-right"},et={class:"request-count"},st={class:"total"},at={class:"detail"},lt={class:"success"},nt={class:"error"},ot={class:"progress-wrap"},it={class:"progress-bar"},ut={class:"progress-text"},rt={class:"col-right"},ct={class:"token-value"},dt={class:"col-right"},vt={class:"duration-value"},_t={class:"time-text"},pt={class:"load-bar-wrap"},gt={class:"load-bar"},ht={class:"load-text"},ft={key:0,class:"loading-state"},mt={key:1,class:"empty-state"},bt={__name:"AccountLoad",setup(St){const i=c(!1),v=c([]),_=c("24h"),p=c(""),g=c(""),u=c(""),r=c(""),O=[{label:"1小时",value:"1h"},{label:"24小时",value:"24h"},{label:"7天",value:"7d"},{label:"30天",value:"30d"},{label:"自定义",value:"custom"}],q=V(()=>Math.max(...v.value.map(e=>e.request_count),1));function M(e){return e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e||0}function T(e){return e?new Date(e).toLocaleString("zh-CN"):"-"}function b(e){return e.request_count===0?100:Math.round(e.success_count/e.request_count*100)}function B(e){const s=b(e);return s>=95?"success":s>=80?"warning":"error"}function S(e){return Math.round(e.request_count/q.value*100)}function F(e){const s=S(e);return s>80?"var(--apple-red)":s>50?"var(--apple-orange)":"var(--apple-green)"}function k(){const e=new Date;switch(_.value){case"1h":u.value=new Date(e-60*60*1e3).toISOString(),r.value=e.toISOString(),d();break;case"24h":u.value=new Date(e-24*60*60*1e3).toISOString(),r.value=e.toISOString(),d();break;case"7d":u.value=new Date(e-7*24*60*60*1e3).toISOString(),r.value=e.toISOString(),d();break;case"30d":u.value=new Date(e-30*24*60*60*1e3).toISOString(),r.value=e.toISOString(),d();break}}function y(){p.value&&g.value&&(u.value=new Date(p.value).toISOString(),r.value=new Date(g.value).toISOString(),d())}async function d(){i.value=!0;try{const e={};u.value&&(e.start_time=u.value),r.value&&(e.end_time=r.value);const s=await N.getAccountLoadStats(e);v.value=s.data||[]}catch(e){console.error("Failed to fetch load stats:",e)}finally{i.value=!1}}return w(()=>{k()}),(e,s)=>(o(),n("div",z,[t("div",A,[s[4]||(s[4]=t("div",{class:"header-content"},[t("h1",{class:"page-title"},"账户负载"),t("p",{class:"page-subtitle"},"查看各账户的请求负载和性能统计")],-1)),t("button",{class:"btn btn-outline",onClick:d,disabled:i.value},[(o(),n("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:f({spinning:i.value})},[...s[2]||(s[2]=[t("polyline",{points:"23,4 23,10 17,10"},null,-1),t("path",{d:"M20.49 15a9 9 0 11-2.12-9.36L23 10"},null,-1)])],2)),s[3]||(s[3]=h(" 刷新 ",-1))],8,E)]),t("div",P,[t("div",U,[t("div",G,[s[5]||(s[5]=t("label",{class:"filter-label"},"时间范围",-1)),t("div",H,[(o(),n(x,null,C(O,a=>t("button",{key:a.value,class:f(["range-btn",{active:_.value===a.value}]),onClick:kt=>{_.value=a.value,k()}},l(a.label),11,K)),64))])]),_.value==="custom"?(o(),n("div",$,[s[7]||(s[7]=t("label",{class:"filter-label"},"自定义范围",-1)),t("div",j,[D(t("input",{type:"datetime-local","onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a),class:"date-input",onChange:y},null,544),[[I,p.value]]),s[6]||(s[6]=t("span",{class:"date-sep"},"至",-1)),D(t("input",{type:"datetime-local","onUpdate:modelValue":s[1]||(s[1]=a=>g.value=a),class:"date-input",onChange:y},null,544),[[I,g.value]])])])):m("",!0)])]),t("div",J,[t("div",Q,[t("table",W,[s[11]||(s[11]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"账户名称"),t("th",null,"平台"),t("th",{class:"col-right"},"请求数"),t("th",null,"成功率"),t("th",{class:"col-right"},"Token 使用"),t("th",{class:"col-right"},"平均耗时"),t("th",null,"最后使用"),t("th",null,"负载")])],-1)),i.value?m("",!0):(o(),n("tbody",X,[(o(!0),n(x,null,C(v.value,a=>(o(),n("tr",{key:a.account_id},[t("td",null,[t("code",Y,"#"+l(a.account_id),1)]),t("td",null,[t("span",Z,l(a.account_name),1)]),t("td",null,[t("span",{class:f(["platform-badge",a.platform])},l(a.platform),3)]),t("td",tt,[t("div",et,[t("span",st,l(a.request_count),1),t("span",at,[s[8]||(s[8]=h(" (",-1)),t("span",lt,l(a.success_count),1),s[9]||(s[9]=h(" / ",-1)),t("span",nt,l(a.error_count),1),s[10]||(s[10]=h(") ",-1))])])]),t("td",null,[t("div",ot,[t("div",it,[t("div",{class:f(["progress-fill",B(a)]),style:L({width:b(a)+"%"})},null,6)]),t("span",ut,l(b(a))+"%",1)])]),t("td",rt,[t("span",ct,l(M(a.total_tokens)),1)]),t("td",dt,[t("span",vt,l(a.avg_duration)+"ms",1)]),t("td",null,[t("span",_t,l(T(a.last_used_at)),1)]),t("td",null,[t("div",pt,[t("div",gt,[t("div",{class:"load-fill",style:L({width:S(a)+"%",background:F(a)})},null,4)]),t("span",ht,l(S(a))+"%",1)])])]))),128))]))]),i.value?(o(),n("div",ft,[...s[12]||(s[12]=[t("div",{class:"loading-spinner"},null,-1),t("span",null,"加载中...",-1)])])):m("",!0),!i.value&&v.value.length===0?(o(),n("div",mt,[...s[13]||(s[13]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})],-1),t("span",null,"暂无负载数据",-1)])])):m("",!0)])])]))}},xt=R(bt,[["__scopeId","data-v-3bcfd74c"]]);export{xt as default};
