import{_ as q,r as b,a as K,q as _,N as j,o as J,c as h,b as s,z as Q,s as p,f as a,M as c,v as d,d as F,t as u,F as W,x as X,e as M,p as Y,w as Z,T as ss,l as V,E as S,n as m}from"./index-CQyKkE5B.js";const ts={class:"settings-page"},es={class:"settings-grid"},ns={class:"settings-card"},ls={class:"setting-item"},is={class:"toggle-switch"},as={class:"setting-item"},os={class:"input-with-unit"},ds={class:"setting-item"},us={class:"toggle-switch"},rs={class:"setting-item"},_s={class:"input-with-unit"},cs=["disabled"],ps={class:"setting-item"},vs={class:"input-with-unit"},gs=["disabled"],bs={class:"settings-card"},ms={class:"setting-item"},fs={class:"input-with-unit"},hs={class:"setting-item"},ys={class:"input-with-unit"},ks={class:"setting-item"},xs={class:"input-with-unit"},ws={class:"settings-card"},Cs={class:"card-header"},Vs={class:"card-title-row"},Ss={class:"header-badges"},Us=["disabled"],zs={class:"setting-item"},Ts={class:"toggle-switch"},As={class:"setting-item"},Es={class:"input-with-unit"},Bs=["disabled"],Ms={class:"setting-item"},Os={class:"input-with-unit"},Ds=["disabled"],Hs={class:"setting-item"},Is={class:"toggle-switch"},Ls=["disabled"],Ns={class:"setting-item"},Fs={class:"toggle-switch"},Gs=["disabled"],Rs={class:"setting-item"},Ps={class:"toggle-switch"},$s=["disabled"],qs={class:"setting-item"},Ks={class:"input-with-unit"},js=["disabled"],Js={class:"settings-card"},Qs={class:"setting-item"},Ws={class:"toggle-switch"},Xs=["disabled"],Ys={class:"setting-item"},Zs={class:"input-with-unit"},st=["disabled"],tt={class:"setting-item"},et={class:"input-with-unit"},nt=["disabled"],lt={class:"setting-item"},it={class:"input-with-unit"},at=["disabled"],ot={class:"setting-item"},dt={class:"input-with-unit"},ut=["disabled"],rt={class:"setting-item"},_t={class:"input-with-unit"},ct=["disabled"],pt={class:"setting-item"},vt={class:"toggle-switch"},gt=["disabled"],bt={class:"setting-item"},mt={class:"input-with-unit"},ft=["disabled"],ht={class:"setting-item"},yt={class:"input-with-unit"},kt=["disabled"],xt={class:"setting-item"},wt={class:"input-with-unit"},Ct=["disabled"],Vt={class:"settings-card"},St={class:"card-header"},Ut={class:"card-title-row"},zt={class:"header-badges"},Tt={class:"setting-item"},At={class:"toggle-switch"},Et={class:"setting-item"},Bt={class:"input-with-unit"},Mt=["disabled"],Ot={class:"setting-item"},Dt={class:"input-with-unit"},Ht={class:"setting-item"},It={class:"input-with-unit"},Lt={class:"setting-item"},Nt={class:"toggle-switch"},Ft=["disabled"],Gt={class:"setting-item"},Rt={class:"toggle-switch"},Pt=["disabled"],$t={class:"setting-item"},qt={class:"toggle-switch"},Kt=["disabled"],jt={class:"config-list-card"},Jt={class:"table-container"},Qt={class:"data-table"},Wt={class:"config-key"},Xt={class:"config-value"},Yt={class:"config-desc"},Zt={class:"action-bar"},se=["disabled"],te={key:0,class:"btn-loading"},ee={class:"modal"},ne={class:"modal-header"},le={class:"modal-body"},ie={key:0,class:"health-status-grid"},ae={class:"status-item"},oe={class:"status-item"},de={class:"status-value"},ue={class:"status-item"},re={class:"status-value"},_e={class:"status-item"},ce={class:"status-badge warning"},pe={class:"status-item"},ve={class:"status-value"},ge={class:"status-item"},be={class:"status-item"},me={class:"status-value"},fe={class:"status-item full-width"},he={class:"status-error"},ye={class:"modal-footer"},ke=["disabled"],xe={__name:"Settings",setup(we){const g=b(!1),y=b(!1),U=b(!1),x=b(!1),w=b(!1),r=b(null),e=K({record_retention_days:30,record_max_count:1e3,global_price_rate:1,captcha_enabled:"true",captcha_rate_limit:10,login_rate_limit_enable:"true",login_rate_limit_count:3,login_rate_limit_window:5,account_health_check_enabled:"false",account_health_check_interval:5,account_error_threshold:5,oauth_auto_reauthorize_enabled:"true",oauth_reauthorize_cooldown:30,health_check_auto_recovery:"true",health_check_auto_token_refresh:"true",rate_limited_probe_enabled:"true",rate_limited_probe_init_interval:10,rate_limited_probe_max_interval:30,rate_limited_probe_backoff:1.5,suspended_probe_interval:5,suspended_confirm_threshold:3,banned_probe_enabled:"false",banned_probe_interval:1,token_refresh_cooldown:30,token_refresh_max_retries:3,usage_sync_enabled:"false",usage_sync_interval:60,usage_sync_cache_ttl:5,usage_sync_concurrency:5,sync_claude_enabled:"true",sync_openai_enabled:"true",sync_gemini_enabled:"true"}),z=b([]);function i(){U.value=!0}const O=_({get:()=>e.captcha_enabled==="true",set:l=>{e.captcha_enabled=l?"true":"false"}}),C=_({get:()=>e.login_rate_limit_enable==="true",set:l=>{e.login_rate_limit_enable=l?"true":"false"}}),o=_({get:()=>e.account_health_check_enabled==="true",set:l=>{e.account_health_check_enabled=l?"true":"false"}}),T=_({get:()=>e.oauth_auto_reauthorize_enabled==="true",set:l=>{e.oauth_auto_reauthorize_enabled=l?"true":"false"}}),D=_({get:()=>e.health_check_auto_recovery==="true",set:l=>{e.health_check_auto_recovery=l?"true":"false"}}),H=_({get:()=>e.health_check_auto_token_refresh==="true",set:l=>{e.health_check_auto_token_refresh=l?"true":"false"}}),k=_({get:()=>e.rate_limited_probe_enabled==="true",set:l=>{e.rate_limited_probe_enabled=l?"true":"false"}}),A=_({get:()=>e.banned_probe_enabled==="true",set:l=>{e.banned_probe_enabled=l?"true":"false"}}),v=_({get:()=>e.usage_sync_enabled==="true",set:l=>{e.usage_sync_enabled=l?"true":"false"}}),I=_({get:()=>e.sync_claude_enabled==="true",set:l=>{e.sync_claude_enabled=l?"true":"false"}}),L=_({get:()=>e.sync_openai_enabled==="true",set:l=>{e.sync_openai_enabled=l?"true":"false"}}),N=_({get:()=>e.sync_gemini_enabled==="true",set:l=>{e.sync_gemini_enabled=l?"true":"false"}});function G(l){return l?new Date(l).toLocaleString("zh-CN"):""}async function E(){g.value=!0;try{const t=(await V.getSystemConfigs()).items||[];z.value=t.filter(n=>n.category!=="email");for(const n of z.value)n.key in e&&(n.type==="int"?e[n.key]=parseInt(n.value)||0:n.type==="float"?e[n.key]=parseFloat(n.value)||0:e[n.key]=n.value);U.value=!1}catch(l){console.error("Failed to load configs:",l)}finally{g.value=!1}}async function R(){y.value=!0;try{const l={record_retention_days:String(e.record_retention_days),record_max_count:String(e.record_max_count),global_price_rate:String(e.global_price_rate),captcha_enabled:e.captcha_enabled,captcha_rate_limit:String(e.captcha_rate_limit),login_rate_limit_enable:e.login_rate_limit_enable,login_rate_limit_count:String(e.login_rate_limit_count),login_rate_limit_window:String(e.login_rate_limit_window),account_health_check_enabled:e.account_health_check_enabled,account_health_check_interval:String(e.account_health_check_interval),account_error_threshold:String(e.account_error_threshold),oauth_auto_reauthorize_enabled:e.oauth_auto_reauthorize_enabled,oauth_reauthorize_cooldown:String(e.oauth_reauthorize_cooldown),health_check_auto_recovery:e.health_check_auto_recovery,health_check_auto_token_refresh:e.health_check_auto_token_refresh,rate_limited_probe_enabled:e.rate_limited_probe_enabled,rate_limited_probe_init_interval:String(e.rate_limited_probe_init_interval),rate_limited_probe_max_interval:String(e.rate_limited_probe_max_interval),rate_limited_probe_backoff:String(e.rate_limited_probe_backoff),suspended_probe_interval:String(e.suspended_probe_interval),suspended_confirm_threshold:String(e.suspended_confirm_threshold),banned_probe_enabled:e.banned_probe_enabled,banned_probe_interval:String(e.banned_probe_interval),token_refresh_cooldown:String(e.token_refresh_cooldown),token_refresh_max_retries:String(e.token_refresh_max_retries)};await V.updateSystemConfigs(l),S.success("配置保存成功"),U.value=!1,await E()}catch{S.error("保存失败")}finally{y.value=!1}}async function P(){x.value=!0,await B()}async function B(){try{const l=await V.getHealthCheckStatus();r.value=l}catch(l){console.error("Failed to get health status:",l)}}let f=null;async function $(){w.value=!0;try{await V.triggerHealthCheck(),S.success("健康检测已触发"),f&&clearTimeout(f),f=setTimeout(B,2e3)}catch{S.error("触发失败")}finally{w.value=!1}}return j(()=>{f&&(clearTimeout(f),f=null)}),J(()=>{E()}),(l,t)=>(m(),h("div",ts,[t[127]||(t[127]=s("div",{class:"page-header"},[s("div",{class:"header-content"},[s("h1",{class:"page-title"},"系统设置"),s("p",{class:"page-subtitle"},"配置系统参数、安全策略和账号健康检查")])],-1)),s("div",es,[s("div",ns,[t[45]||(t[45]=s("div",{class:"card-header"},[s("div",{class:"card-icon security"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})])]),s("h3",null,"安全配置")],-1)),s("div",{class:p(["card-body",{loading:g.value}])},[s("div",ls,[t[35]||(t[35]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用登录验证码"),s("span",{class:"setting-desc"},"开启后登录需要输入图片验证码")],-1)),s("label",is,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=n=>O.value=n),onChange:i},null,544),[[c,O.value]]),t[34]||(t[34]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",as,[t[37]||(t[37]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"验证码频率限制"),s("span",{class:"setting-desc"},"每个 IP 每分钟最多获取验证码次数")],-1)),s("div",os,[a(s("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=n=>e.captcha_rate_limit=n),min:"1",max:"100",class:"form-input",onChange:i},null,544),[[d,e.captcha_rate_limit,void 0,{number:!0}]]),t[36]||(t[36]=s("span",{class:"unit"},"次/分钟",-1))])]),t[44]||(t[44]=s("div",{class:"setting-divider"},null,-1)),s("div",ds,[t[39]||(t[39]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用登录频率限制"),s("span",{class:"setting-desc"},"防止暴力破解，限制登录尝试次数")],-1)),s("label",us,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=n=>C.value=n),onChange:i},null,544),[[c,C.value]]),t[38]||(t[38]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",rs,[t[41]||(t[41]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"登录限制次数"),s("span",{class:"setting-desc"},"时间窗口内允许的最大登录尝试次数")],-1)),s("div",_s,[a(s("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=n=>e.login_rate_limit_count=n),min:"1",max:"100",class:"form-input",disabled:!C.value,onChange:i},null,40,cs),[[d,e.login_rate_limit_count,void 0,{number:!0}]]),t[40]||(t[40]=s("span",{class:"unit"},"次",-1))])]),s("div",ps,[t[43]||(t[43]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"登录限制窗口"),s("span",{class:"setting-desc"},"频率限制的时间窗口")],-1)),s("div",vs,[a(s("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=n=>e.login_rate_limit_window=n),min:"1",max:"60",class:"form-input",disabled:!C.value,onChange:i},null,40,gs),[[d,e.login_rate_limit_window,void 0,{number:!0}]]),t[42]||(t[42]=s("span",{class:"unit"},"分钟",-1))])])],2)]),s("div",bs,[t[53]||(t[53]=F('<div class="card-header" data-v-ac465f71><div class="card-icon records" data-v-ac465f71><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-ac465f71><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" data-v-ac465f71></path><polyline points="14,2 14,8 20,8" data-v-ac465f71></polyline><line x1="16" y1="13" x2="8" y2="13" data-v-ac465f71></line><line x1="16" y1="17" x2="8" y2="17" data-v-ac465f71></line></svg></div><h3 data-v-ac465f71>记录配置</h3></div>',1)),s("div",{class:p(["card-body",{loading:g.value}])},[s("div",ms,[t[47]||(t[47]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"记录保留天数"),s("span",{class:"setting-desc"},"使用记录的保留时间")],-1)),s("div",fs,[a(s("input",{type:"number","onUpdate:modelValue":t[5]||(t[5]=n=>e.record_retention_days=n),min:"1",max:"365",class:"form-input",onChange:i},null,544),[[d,e.record_retention_days,void 0,{number:!0}]]),t[46]||(t[46]=s("span",{class:"unit"},"天",-1))])]),s("div",hs,[t[49]||(t[49]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"最大记录数"),s("span",{class:"setting-desc"},"每个用户保留的最大记录数")],-1)),s("div",ys,[a(s("input",{type:"number","onUpdate:modelValue":t[6]||(t[6]=n=>e.record_max_count=n),min:"100",max:"10000",step:"100",class:"form-input",onChange:i},null,544),[[d,e.record_max_count,void 0,{number:!0}]]),t[48]||(t[48]=s("span",{class:"unit"},"条/用户",-1))])]),t[52]||(t[52]=s("div",{class:"setting-divider"},null,-1)),s("div",ks,[t[51]||(t[51]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"全局价格倍率"),s("span",{class:"setting-desc"},"1=原价，0=免费，2=2倍。优先级：全局 → 用户")],-1)),s("div",xs,[a(s("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=n=>e.global_price_rate=n),min:"0",max:"10",step:"0.1",class:"form-input",onChange:i},null,544),[[d,e.global_price_rate,void 0,{number:!0}]]),t[50]||(t[50]=s("span",{class:"unit"},"倍",-1))])])],2)]),s("div",ws,[s("div",Cs,[t[55]||(t[55]=s("div",{class:"card-icon health"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})])],-1)),s("div",Vs,[t[54]||(t[54]=s("h3",null,"账号健康检查",-1)),s("div",Ss,[s("span",{class:p(["status-badge",o.value?"success":"muted"])},u(o.value?"已启用":"已禁用"),3),s("button",{class:"btn btn-sm btn-outline",onClick:P,disabled:!o.value}," 查看状态 ",8,Us)])])]),s("div",{class:p(["card-body",{loading:g.value}])},[s("div",zs,[t[57]||(t[57]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用健康检查"),s("span",{class:"setting-desc"},"定期检查 OAuth 账号的有效性")],-1)),s("label",Ts,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=n=>o.value=n),onChange:i},null,544),[[c,o.value]]),t[56]||(t[56]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",As,[t[59]||(t[59]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"检查间隔"),s("span",{class:"setting-desc"},"正常账号的定期检查间隔")],-1)),s("div",Es,[a(s("input",{type:"number","onUpdate:modelValue":t[9]||(t[9]=n=>e.account_health_check_interval=n),min:"1",max:"60",class:"form-input",disabled:!o.value,onChange:i},null,40,Bs),[[d,e.account_health_check_interval,void 0,{number:!0}]]),t[58]||(t[58]=s("span",{class:"unit"},"分钟",-1))])]),s("div",Ms,[t[61]||(t[61]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"连续错误阈值"),s("span",{class:"setting-desc"},"连续检查失败达到此次数后标记为疑似封号")],-1)),s("div",Os,[a(s("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=n=>e.account_error_threshold=n),min:"1",max:"100",class:"form-input",disabled:!o.value,onChange:i},null,40,Ds),[[d,e.account_error_threshold,void 0,{number:!0}]]),t[60]||(t[60]=s("span",{class:"unit"},"次",-1))])]),t[70]||(t[70]=s("div",{class:"setting-section-title"},"恢复策略",-1)),s("div",Hs,[t[63]||(t[63]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"自动恢复"),s("span",{class:"setting-desc"},"检测通过时自动恢复账号为正常状态")],-1)),s("label",Is,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=n=>D.value=n),disabled:!o.value,onChange:i},null,40,Ls),[[c,D.value]]),t[62]||(t[62]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",Ns,[t[65]||(t[65]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"自动刷新 Token"),s("span",{class:"setting-desc"},"Token 过期时自动尝试刷新")],-1)),s("label",Fs,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=n=>H.value=n),disabled:!o.value,onChange:i},null,40,Gs),[[c,H.value]]),t[64]||(t[64]=s("span",{class:"toggle-slider"},null,-1))])]),t[71]||(t[71]=s("div",{class:"setting-section-title"},"OAuth 配置",-1)),s("div",Rs,[t[67]||(t[67]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"OAuth 自动重授权"),s("span",{class:"setting-desc"},"OAuth Token 失效时，自动使用 SessionKey 重新获取 Token")],-1)),s("label",Ps,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=n=>T.value=n),disabled:!o.value,onChange:i},null,40,$s),[[c,T.value]]),t[66]||(t[66]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",qs,[t[69]||(t[69]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"重授权冷却时间"),s("span",{class:"setting-desc"},"重新授权失败后的冷却时间")],-1)),s("div",Ks,[a(s("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=n=>e.oauth_reauthorize_cooldown=n),min:"5",max:"1440",class:"form-input",disabled:!o.value||!T.value,onChange:i},null,40,js),[[d,e.oauth_reauthorize_cooldown,void 0,{number:!0}]]),t[68]||(t[68]=s("span",{class:"unit"},"分钟",-1))])])],2)]),s("div",Js,[t[96]||(t[96]=F('<div class="card-header" data-v-ac465f71><div class="card-icon strategy" data-v-ac465f71><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-ac465f71><line x1="4" y1="21" x2="4" y2="14" data-v-ac465f71></line><line x1="4" y1="10" x2="4" y2="3" data-v-ac465f71></line><line x1="12" y1="21" x2="12" y2="12" data-v-ac465f71></line><line x1="12" y1="8" x2="12" y2="3" data-v-ac465f71></line><line x1="20" y1="21" x2="20" y2="16" data-v-ac465f71></line><line x1="20" y1="12" x2="20" y2="3" data-v-ac465f71></line><line x1="1" y1="14" x2="7" y2="14" data-v-ac465f71></line><line x1="9" y1="8" x2="15" y2="8" data-v-ac465f71></line><line x1="17" y1="16" x2="23" y2="16" data-v-ac465f71></line></svg></div><h3 data-v-ac465f71>分级检测策略</h3></div>',1)),s("div",{class:p(["card-body",{loading:g.value}])},[t[92]||(t[92]=s("div",{class:"setting-section-title"},"限流账号探测",-1)),s("div",Qs,[t[73]||(t[73]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用主动探测"),s("span",{class:"setting-desc"},"限流账号不等待官方 reset 时间，主动探测恢复")],-1)),s("label",Ws,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=n=>k.value=n),disabled:!o.value,onChange:i},null,40,Xs),[[c,k.value]]),t[72]||(t[72]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",Ys,[t[75]||(t[75]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"初始探测间隔"),s("span",{class:"setting-desc"},"限流后首次探测的等待时间")],-1)),s("div",Zs,[a(s("input",{type:"number","onUpdate:modelValue":t[16]||(t[16]=n=>e.rate_limited_probe_init_interval=n),min:"1",max:"60",class:"form-input",disabled:!o.value||!k.value,onChange:i},null,40,st),[[d,e.rate_limited_probe_init_interval,void 0,{number:!0}]]),t[74]||(t[74]=s("span",{class:"unit"},"分钟",-1))])]),s("div",tt,[t[77]||(t[77]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"最大探测间隔"),s("span",{class:"setting-desc"},"探测间隔递增的上限")],-1)),s("div",et,[a(s("input",{type:"number","onUpdate:modelValue":t[17]||(t[17]=n=>e.rate_limited_probe_max_interval=n),min:"10",max:"120",class:"form-input",disabled:!o.value||!k.value,onChange:i},null,40,nt),[[d,e.rate_limited_probe_max_interval,void 0,{number:!0}]]),t[76]||(t[76]=s("span",{class:"unit"},"分钟",-1))])]),s("div",lt,[t[79]||(t[79]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"间隔递增因子"),s("span",{class:"setting-desc"},"每次失败后间隔乘以此因子")],-1)),s("div",it,[a(s("input",{type:"number","onUpdate:modelValue":t[18]||(t[18]=n=>e.rate_limited_probe_backoff=n),min:"1",max:"3",step:"0.1",class:"form-input",disabled:!o.value||!k.value,onChange:i},null,40,at),[[d,e.rate_limited_probe_backoff,void 0,{number:!0}]]),t[78]||(t[78]=s("span",{class:"unit"},"倍",-1))])]),t[93]||(t[93]=s("div",{class:"setting-section-title"},"疑似封号检测",-1)),s("div",ot,[t[81]||(t[81]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"探测间隔"),s("span",{class:"setting-desc"},"疑似封号账号的探测间隔")],-1)),s("div",dt,[a(s("input",{type:"number","onUpdate:modelValue":t[19]||(t[19]=n=>e.suspended_probe_interval=n),min:"1",max:"60",class:"form-input",disabled:!o.value,onChange:i},null,40,ut),[[d,e.suspended_probe_interval,void 0,{number:!0}]]),t[80]||(t[80]=s("span",{class:"unit"},"分钟",-1))])]),s("div",rt,[t[83]||(t[83]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"确认封号阈值"),s("span",{class:"setting-desc"},"连续失败此次数后确认为封号状态")],-1)),s("div",_t,[a(s("input",{type:"number","onUpdate:modelValue":t[20]||(t[20]=n=>e.suspended_confirm_threshold=n),min:"1",max:"10",class:"form-input",disabled:!o.value,onChange:i},null,40,ct),[[d,e.suspended_confirm_threshold,void 0,{number:!0}]]),t[82]||(t[82]=s("span",{class:"unit"},"次",-1))])]),t[94]||(t[94]=s("div",{class:"setting-section-title"},"封号账号复活检测",-1)),s("div",pt,[t[85]||(t[85]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用复活检测"),s("span",{class:"setting-desc"},"定期检测已封号账号是否恢复")],-1)),s("label",vt,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[21]||(t[21]=n=>A.value=n),disabled:!o.value,onChange:i},null,40,gt),[[c,A.value]]),t[84]||(t[84]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",bt,[t[87]||(t[87]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"复活探测间隔"),s("span",{class:"setting-desc"},"封号账号的复活检测间隔")],-1)),s("div",mt,[a(s("input",{type:"number","onUpdate:modelValue":t[22]||(t[22]=n=>e.banned_probe_interval=n),min:"1",max:"24",class:"form-input",disabled:!o.value||!A.value,onChange:i},null,40,ft),[[d,e.banned_probe_interval,void 0,{number:!0}]]),t[86]||(t[86]=s("span",{class:"unit"},"小时",-1))])]),t[95]||(t[95]=s("div",{class:"setting-section-title"},"Token 刷新",-1)),s("div",ht,[t[89]||(t[89]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"刷新冷却时间"),s("span",{class:"setting-desc"},"Token 刷新失败后的冷却时间")],-1)),s("div",yt,[a(s("input",{type:"number","onUpdate:modelValue":t[23]||(t[23]=n=>e.token_refresh_cooldown=n),min:"5",max:"120",class:"form-input",disabled:!o.value,onChange:i},null,40,kt),[[d,e.token_refresh_cooldown,void 0,{number:!0}]]),t[88]||(t[88]=s("span",{class:"unit"},"分钟",-1))])]),s("div",xt,[t[91]||(t[91]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"最大重试次数"),s("span",{class:"setting-desc"},"Token 刷新的最大重试次数")],-1)),s("div",wt,[a(s("input",{type:"number","onUpdate:modelValue":t[24]||(t[24]=n=>e.token_refresh_max_retries=n),min:"1",max:"10",class:"form-input",disabled:!o.value,onChange:i},null,40,Ct),[[d,e.token_refresh_max_retries,void 0,{number:!0}]]),t[90]||(t[90]=s("span",{class:"unit"},"次",-1))])])],2)]),s("div",Vt,[s("div",St,[t[98]||(t[98]=s("div",{class:"card-icon sync"},[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M21 12a9 9 0 11-6.219-8.56"}),s("polyline",{points:"21,4 21,12 13,12"})])],-1)),s("div",Ut,[t[97]||(t[97]=s("h3",null,"用量同步配置",-1)),s("div",zt,[s("span",{class:p(["status-badge",v.value?"success":"muted"])},u(v.value?"已启用":"已禁用"),3)])])]),s("div",{class:p(["card-body",{loading:g.value}])},[s("div",Tt,[t[100]||(t[100]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"启用自动同步"),s("span",{class:"setting-desc"},"定期自动同步账户用量信息（Claude/OpenAI/Gemini）")],-1)),s("label",At,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[25]||(t[25]=n=>v.value=n),onChange:i},null,544),[[c,v.value]]),t[99]||(t[99]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",Et,[t[102]||(t[102]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"同步间隔"),s("span",{class:"setting-desc"},"自动同步用量的时间间隔")],-1)),s("div",Bt,[a(s("input",{type:"number","onUpdate:modelValue":t[26]||(t[26]=n=>e.usage_sync_interval=n),min:"5",max:"1440",class:"form-input",disabled:!v.value,onChange:i},null,40,Mt),[[d,e.usage_sync_interval,void 0,{number:!0}]]),t[101]||(t[101]=s("span",{class:"unit"},"分钟",-1))])]),t[113]||(t[113]=s("div",{class:"setting-divider"},null,-1)),s("div",Ot,[t[104]||(t[104]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"缓存有效期"),s("span",{class:"setting-desc"},"避免频繁查询同一账户的缓存时间")],-1)),s("div",Dt,[a(s("input",{type:"number","onUpdate:modelValue":t[27]||(t[27]=n=>e.usage_sync_cache_ttl=n),min:"1",max:"60",class:"form-input",onChange:i},null,544),[[d,e.usage_sync_cache_ttl,void 0,{number:!0}]]),t[103]||(t[103]=s("span",{class:"unit"},"分钟",-1))])]),s("div",Ht,[t[106]||(t[106]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"并发查询数"),s("span",{class:"setting-desc"},"批量同步时的最大并发请求数")],-1)),s("div",It,[a(s("input",{type:"number","onUpdate:modelValue":t[28]||(t[28]=n=>e.usage_sync_concurrency=n),min:"1",max:"20",class:"form-input",onChange:i},null,544),[[d,e.usage_sync_concurrency,void 0,{number:!0}]]),t[105]||(t[105]=s("span",{class:"unit"},"个",-1))])]),t[114]||(t[114]=s("div",{class:"setting-section-title"},"同步范围",-1)),s("div",Lt,[t[108]||(t[108]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"同步 Claude 账户"),s("span",{class:"setting-desc"},"同步 Claude Official OAuth 账户的 5H/7D 用量")],-1)),s("label",Nt,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=n=>I.value=n),disabled:!v.value,onChange:i},null,40,Ft),[[c,I.value]]),t[107]||(t[107]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",Gt,[t[110]||(t[110]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"同步 OpenAI 账户"),s("span",{class:"setting-desc"},"同步 OpenAI Codex 用量（从响应头提取）")],-1)),s("label",Rt,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[30]||(t[30]=n=>L.value=n),disabled:!v.value,onChange:i},null,40,Pt),[[c,L.value]]),t[109]||(t[109]=s("span",{class:"toggle-slider"},null,-1))])]),s("div",$t,[t[112]||(t[112]=s("div",{class:"setting-info"},[s("span",{class:"setting-label"},"同步 Gemini 账户"),s("span",{class:"setting-desc"},"同步 Gemini Code Assist 项目 ID")],-1)),s("label",qt,[a(s("input",{type:"checkbox","onUpdate:modelValue":t[31]||(t[31]=n=>N.value=n),disabled:!v.value,onChange:i},null,40,Kt),[[c,N.value]]),t[111]||(t[111]=s("span",{class:"toggle-slider"},null,-1))])])],2)])]),s("div",jt,[t[116]||(t[116]=s("div",{class:"card-header"},[s("h3",null,"配置项列表")],-1)),s("div",Jt,[s("table",Qt,[t[115]||(t[115]=s("thead",null,[s("tr",null,[s("th",null,"配置项"),s("th",null,"当前值"),s("th",null,"说明")])],-1)),s("tbody",null,[(m(!0),h(W,null,X(z.value,n=>(m(),h("tr",{key:n.key},[s("td",null,[s("code",Wt,u(n.key),1)]),s("td",null,[s("span",Xt,u(n.value),1)]),s("td",Yt,u(n.desc),1)]))),128))])])])]),s("div",Zt,[s("button",{class:"btn btn-secondary",onClick:E},"重置"),s("button",{class:"btn btn-primary",onClick:R,disabled:y.value},[y.value?(m(),h("span",te)):M("",!0),Y(" "+u(y.value?"保存中...":"保存配置"),1)],8,se)]),(m(),Q(ss,{to:"body"},[x.value?(m(),h("div",{key:0,class:"modal-overlay",onClick:t[33]||(t[33]=Z(n=>x.value=!1,["self"]))},[s("div",ee,[s("div",ne,[t[118]||(t[118]=s("h2",null,"健康检测服务状态",-1)),s("button",{class:"modal-close",onClick:t[32]||(t[32]=n=>x.value=!1)},[...t[117]||(t[117]=[s("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),s("div",le,[r.value?(m(),h("div",ie,[s("div",ae,[t[119]||(t[119]=s("span",{class:"status-label"},"服务状态",-1)),s("span",{class:p(["status-badge",r.value.running?"success":"danger"])},u(r.value.running?"运行中":"已停止"),3)]),s("div",oe,[t[120]||(t[120]=s("span",{class:"status-label"},"检测间隔",-1)),s("span",de,u(r.value.interval)+" 分钟",1)]),s("div",ue,[t[121]||(t[121]=s("span",{class:"status-label"},"上次检测",-1)),s("span",re,u(r.value.last_check?G(r.value.last_check):"暂无"),1)]),s("div",_e,[t[122]||(t[122]=s("span",{class:"status-label"},"问题账号数",-1)),s("span",ce,u(r.value.problem_account_count||0),1)]),s("div",pe,[t[123]||(t[123]=s("span",{class:"status-label"},"已检测账号数",-1)),s("span",ve,u(r.value.checked_count||0),1)]),s("div",ge,[t[124]||(t[124]=s("span",{class:"status-label"},"失败账号数",-1)),s("span",{class:p(["status-badge",r.value.failed_count>0?"danger":"muted"])},u(r.value.failed_count||0),3)]),s("div",be,[t[125]||(t[125]=s("span",{class:"status-label"},"错误阈值",-1)),s("span",me,u(r.value.threshold)+" 次",1)]),s("div",fe,[t[126]||(t[126]=s("span",{class:"status-label"},"最后错误",-1)),s("span",he,u(r.value.last_error||"无"),1)])])):M("",!0)]),s("div",ye,[s("button",{class:"btn btn-secondary",onClick:B},"刷新状态"),s("button",{class:"btn btn-primary",onClick:$,disabled:w.value},u(w.value?"触发中...":"手动触发检测"),9,ke)])])])):M("",!0)]))]))}},Ve=q(xe,[["__scopeId","data-v-ac465f71"]]);export{Ve as default};
